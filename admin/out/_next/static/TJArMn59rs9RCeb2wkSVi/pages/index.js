(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{RNiq:function(e,t,n){"use strict";n.r(t);var a=n("ln6h"),r=n.n(a),u=n("O40h"),c=n("q1tI"),s=n.n(c),o=(n("MLBV"),n("QcfS")),i=n("fIpK"),l=n("tCWA"),p=n("obyI");function d(){return f.apply(this,arguments)}function f(){return(f=Object(u.a)(r.a.mark(function e(){var t,n,a,u,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.a)(p.a.apiPrefix+"/resources/services.json",{headers:Object(i.e)({"Content-Type":"application/json"})});case 3:if(!(t=e.sent).ok){e.next=23;break}return e.next=7,t.json();case 7:n=e.sent,a=0;case 9:if(!(a<n.length)){e.next=20;break}if(u=n[a],c=u.last_sync){e.next=14;break}return e.abrupt("continue",17);case 14:c.startString=c.start,c.start=Date.parse(c.start),c.end&&(c.endString=c.end,c.end=Date.parse(c.end));case 17:++a,e.next=9;break;case 20:return e.abrupt("return",n);case 23:return e.next=25,Object(i.d)(t);case 25:e.next=30;break;case 27:throw e.prev=27,e.t0=e.catch(0),"Could not complete fetch: "+e.t0;case 30:case"end":return e.stop()}},e,null,[[0,27]])}))).apply(this,arguments)}function k(e){return m.apply(this,arguments)}function m(){return(m=Object(u.a)(r.a.mark(function e(t){var n,a,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.a.apiPrefix+"/resources/service/sync.json?service="+t,e.next=3,Object(l.a)(n,{method:"POST",headers:Object(i.e)({"Content-Type":"application/json","X-CSRF-Token":Object(o.b)()}),credentials:"include"});case 3:if((a=e.sent).ok){e.next=7;break}return e.next=7,Object(i.d)(a);case 7:return e.next=9,a.json();case 9:return u=e.sent,e.abrupt("return",u);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(){return v.apply(this,arguments)}function v(){return(v=Object(u.a)(r.a.mark(function e(){var t,n,a,u,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.a)(p.a.apiPrefix+"/resources/targets.json",{headers:Object(i.e)({"Content-Type":"application/json"})});case 3:if(!(t=e.sent).ok){e.next=12;break}return e.next=7,t.json();case 7:for(n=e.sent,a=0;a<n.length;++a)u=n[a],c=u.url.split("://"),u.kind=c[0],u.path=decodeURIComponent(c[1].substring(1));return e.abrupt("return",n);case 12:return e.next=14,Object(i.d)(t);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(0),"Could not complete fetch: "+e.t0;case 19:case"end":return e.stop()}},e,null,[[0,16]])}))).apply(this,arguments)}function h(e,t){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(r.a.mark(function e(t,n){var a,u;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.a.apiPrefix+"/resources/target/"+t+".json?url="+encodeURIComponent(n),u=null,e.prev=2,e.next=5,Object(l.a)(a,{method:"POST",headers:Object(i.e)({"Content-Type":"application/json","X-CSRF-Token":Object(o.b)()}),credentials:"include"});case 5:if((u=e.sent).ok){e.next=9;break}return e.next=9,Object(i.d)(u);case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(2),"Could not complete fetch: "+e.t0;case 14:return e.prev=14,e.next=17,u.json();case 17:return e.abrupt("return",e.sent);case 20:throw e.prev=20,e.t1=e.catch(14),"Could not parse JSON: "+e.t1;case 23:case"end":return e.stop()}},e,null,[[2,11],[14,20]])}))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=Object(u.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h("remove",t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function j(e){return g.apply(this,arguments)}function g(){return(g=Object(u.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h("add",t));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(){return N.apply(this,arguments)}function N(){return(N=Object(u.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.a)(p.a.apiPrefix+"/resources/config.json",{headers:Object(i.e)({"Content-Type":"application/json"})});case 3:if(!(t=e.sent).ok){e.next=10;break}return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 10:return e.next=12,Object(i.d)(t);case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(0),"Could not complete fetch: "+e.t0;case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}var C=n("Wgwc"),S=n.n(C),_=s.a.createElement;function T(){return(T=Object(u.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(t.metadata.id);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e){var t=e.service,n=t.last_sync,a=n?S()(n.start).fromNow():"Never",r=n&&n.end?S()(n.end).add(t.hours_per_sync,"hour"):S()(),u=r?""+r:"",s=n?n.startString:null,o=Object(c.useCallback)(function(e){e.stopPropagation(),function(e){T.apply(this,arguments)}(t)},[t]);return _("div",{className:"uk-card uk-card-default uk-card-hover uk-margin"},_("div",{className:"uk-card-header"},_("div",{className:"uk-grid-small uk-flex-middle","uk-grid":"true"},_("div",{className:"uk-width-auto"},_("img",{className:"uk-border",width:"40",height:"40",src:"/static/images/logo-"+t.metadata.id+".png"})),_("div",{className:"uk-width-expand"},_("h3",{className:"uk-card-title uk-margin-remove-bottom"},t.metadata.name),_("p",{className:"uk-text-meta uk-margin-remove-top"},"Last synced: ",_("time",{dateTime:s},a)," ",n?"("+(n.fetch_count||0)+" downloaded) ":null,"\u2014 Next sync: ",_("time",{dateTime:u},r.fromNow()))))),t.needs_credentials?_("div",{className:"uk-card-body uk-padding-remove-vertical uk-margin"},_("div",{className:"uk-alert-warning","uk-alert":"true"},_("p",null,"It looks like your permission is required before we can sync this service for you. Clicking this button will send you to ",t.metadata.name,"\u2019s website, where you can grant permission to download these items for you, and you\u2019ll be returned here afterwards."),_("div",{className:"uk-panel"},_("p",{className:"uk-align-right"},_("a",{href:t.credential_redirect_url,className:"uk-button uk-button-primary"},"Grant Permission"))))):null,_("div",{className:"uk-card-footer"},_("a",{href:"#",className:"uk-button uk-button-text"},"View details"),_("p",{className:"uk-align-right"},t.needs_credentials?null:_("button",{className:"uk-button uk-button-primary",disabled:t.current_sync,onClick:o},t.current_sync?"Syncing...":"Sync now"))))}var P=s.a.createElement;function E(e){var t=e.target,n=e.onRemoveClick,a=Object(c.useCallback)(function(e){e.preventDefault(),n(t)},[t,n]);return P("div",{className:"uk-card uk-card-default uk-card-hover uk-margin"},P("div",{className:"uk-card-header"},P("div",{className:"uk-grid-small uk-flex-middle","uk-grid":"true"},P("div",{className:"uk-width-auto"},P("span",{className:"uk-border","uk-icon":"icon: folder; ratio: 2"})),P("div",{className:"uk-width-expand"},P("h3",{className:"uk-card-title uk-margin-remove-bottom uk-text-middle"},t.path)),P("div",{className:"uk-width-auto"},P("a",{className:"uk-close-small","uk-close":"true",onClick:a})))))}var I=s.a.createElement;function R(e,t,n){e("file"),t(""),n(!1)}function X(){return(X=Object(u.a)(r.a.mark(function e(t,n,a,u,c){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j(t);case 3:R(a,u,c),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),n(""+e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}))).apply(this,arguments)}function q(e){switch(e){case"file":return"Local Directory";case"gdrive":return"Google Drive";case"dropbox":return"Dropbox";case"s3":return"S3"}return"Unknown"}function A(e){var t=e.enabled,a=e.setIsAdding,r=Object(c.useState)(null),u=r[0],s=r[1],o=Object(c.useState)(null),i=o[0],l=o[1],p=Object(c.useState)("file"),d=p[0],f=p[1],k=Object(c.useState)(""),m=k[0],b=k[1];Object(c.useEffect)(function(){var e=i&&t;return e&&n("gyNX").modal(i).show(),function(){e&&n("gyNX").modal(i).hide()}},[i,t]);var v=Object(c.useCallback)(function(e){e.preventDefault(),R(f,b,a)},[i]),h=Object(c.useCallback)(function(e){l(e)},[]),x=Object(c.useCallback)(function(e){f(e.target.value)},[]),y=Object(c.useCallback)(function(e){b(e.target.value)},[]),w=Object(c.useCallback)(function(e){e.preventDefault(),function(e,t,n,a,r){X.apply(this,arguments)}(d+"://"+("file"===d?"/":"")+m,s,f,b,a)},[d,m]);return I("div",{"uk-modal":"true",ref:h},I("div",{className:"uk-modal-dialog"},I("button",{className:"uk-modal-close-default",type:"button","uk-close":"true",onClick:v}),I("div",{className:"uk-modal-header"},I("h2",{className:"uk-modal-title"},"Summon your media to an additional location")),I("div",{className:"uk-modal-body"},u?I("div",{className:"uk-alert-danger","uk-alert":"true"},I("p",null,I("span",{"uk-icon":"warning"})," ",u)):null,I("p",null,"Choose the additional location where you would like to save your media"),I("form",{className:"uk-form uk-flex",onSubmit:w},I("input",{type:"submit",onSubmit:w,style:{display:"none"}}),I("span",{className:"uk-width-auto","uk-form-custom":"target: true"},I("input",{className:"uk-input uk-width-auto",type:"text",placeholder:q(d)}),I("select",{className:"uk-select",onChange:x,value:d},I("option",{value:"file"},q("file")))),I("input",{type:"text",className:"uk-input uk-width-expand",placeholder:"/path/to/your/media/directory",onChange:y,value:m}))),I("div",{className:"uk-modal-footer uk-text-right"},I("button",{className:"uk-button uk-button-default",type:"button",onClick:v},"Cancel"),I("button",{className:"uk-button uk-button-primary",type:"button",onClick:w},"Save"))))}var J=n("b0oO"),L=n("nOHt"),U=n.n(L);n.d(t,"default",function(){return W});var F=s.a.createElement;function G(){return(G=Object(u.a)(r.a.mark(function e(t,a,u,c){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=n("gyNX"),e.prev=1,e.next=4,s.modal.confirm("Are you sure you want to remove this sync target? ("+t.path+")");case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return");case 9:return e.prev=9,e.next=12,y(t.url);case 12:e.sent,u(a.filter(function(e){return e.url!==t.url})),e.next=19;break;case 16:e.prev=16,e.t1=e.catch(9),c(""+e.t1);case 19:return e.abrupt("return",!1);case 20:case"end":return e.stop()}},e,null,[[1,6],[9,16]])}))).apply(this,arguments)}function M(){return(M=Object(u.a)(r.a.mark(function e(t,n,a,u){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Object(o.a)(t),e.t0=n,e.next=5,d();case 5:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=a,e.next=10,b();case 10:e.t3=e.sent,(0,e.t2)(e.t3),e.next=17;break;case 14:e.prev=14,e.t4=e.catch(0),u(""+e.t4);case 17:case"end":return e.stop()}},e,null,[[0,14]])}))).apply(this,arguments)}function V(){return(V=Object(u.a)(r.a.mark(function e(t,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=t,e.next=4,d();case 4:e.t1=e.sent,(0,e.t0)(e.t1),e.next=11;break;case 8:e.prev=8,e.t2=e.catch(0),n(""+e.t2);case 11:case"end":return e.stop()}},e,null,[[0,8]])}))).apply(this,arguments)}function W(){var e=Object(c.useState)([]),t=e[0],n=e[1],a=Object(c.useState)([]),s=a[0],o=a[1],l=Object(c.useState)(null),p=l[0],d=l[1],f=Object(c.useState)(!1),k=f[0],m=f[1],b=function(){var e=Object(c.useState)({userConfig:void 0,token:void 0}),t=e[0],n=e[1];return Object(c.useEffect)(function(){function e(){return(e=Object(u.a)(r.a.mark(function e(){var t,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(i.b)();case 3:return t=e.sent,e.next=6,O();case 6:a=e.sent,n({userConfig:a,token:t}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),U.a.push("/login");case 13:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),t}(),v=b.userConfig,h=b.token;Object(c.useEffect)(function(){void 0!==v&&function(e,t,n,a){M.apply(this,arguments)}(h,n,o,d)},[v,h,k]),Object(c.useEffect)(function(){if(void 0!==v){var e=setInterval(function(){!function(e,t){V.apply(this,arguments)}(n,d)},1e3);return function(){return clearInterval(e)}}},[v]);var x=Object(c.useCallback)(function(e){!function(e,t,n,a){G.apply(this,arguments)}(e,s,o,d)},[s]),y=Object(c.useCallback)(function(e){e.preventDefault(),m(!0)},[]);return F("div",{className:"uk-container"},F(J.a,{title:"Mediasummon"}),F(A,{setIsAdding:m,enabled:k}),p?F("div",{className:"uk-alert-danger","uk-alert":"true"},F("a",{className:"uk-alert-close","uk-close":"true"}),F("p",null,F("span",{"uk-icon":"warning"})," ",p)):null,F("div",{className:"uk-section uk-section-default uk-padding-remove-top"},F("h3",null,"Summoning your media to these locations"),s.map(function(e){return F(E,{key:e.url,target:e,onRemoveClick:x})}),F("div",{className:"uk-flex uk-flex-center"},F("a",{href:"#","uk-icon":"icon: plus-circle; ratio: 2",onClick:y}))),F("div",{className:"uk-section uk-section-default uk-padding-remove"},F("h3",null,"Summoning media from these services"),t.map(function(e){return F(D,{key:e.metadata.id,service:e})})))}},vlRD:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){var e=n("RNiq");return{page:e.default||e}}])}},[["vlRD",1,0]]]);