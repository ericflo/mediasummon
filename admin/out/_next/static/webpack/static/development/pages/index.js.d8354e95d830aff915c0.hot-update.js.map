{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.d8354e95d830aff915c0.hot-update.js","sources":["webpack:///./components/ServiceSummary.js"],"sourcesContent":["import React from 'react';\r\nimport { useCallback, useState } from 'react';\r\nimport dayjs from 'dayjs';\r\nimport { fetchServiceSyncStart } from '../fetchers/services';\r\nimport OAuthAppForm from './OAuthAppForm';\r\nimport OAuthSetupPrompt from './OAuthSetupPrompt';\r\n\r\nasync function handleSyncClick(service) {\r\n  await fetchServiceSyncStart(service.metadata.id);\r\n}\r\n\r\nexport default function ServiceSummary({service}) {\r\n  const [configuring, setConfiguring] = useState(false);\r\n  const sync = service.last_sync;\r\n  const start = sync ? dayjs(sync.start).fromNow() : 'Never';\r\n  const next = (sync && sync.end) ? dayjs(sync.end).add(service.hours_per_sync, 'hour') : dayjs();\r\n  const nextString = next ? ('' + next) : '';\r\n  const startString = sync ? sync.startString : null;\r\n  const syncCallback = useCallback(ev => {\r\n    ev.stopPropagation();\r\n    handleSyncClick(service);\r\n  }, [service]);\r\n  const handleConfigureClick = useCallback(ev => {\r\n    ev.preventDefault();\r\n    setConfiguring(true);\r\n  }, []);\r\n  const tooltipString = service.app_create_url.split('/')[2];\r\n  return (\r\n    <div className=\"uk-card uk-card-default uk-card-hover uk-margin\">\r\n      <div className=\"uk-card-header\">\r\n        <div className=\"uk-grid-small uk-flex-middle\" uk-grid=\"true\">\r\n          <div className=\"uk-width-auto\">\r\n            <img className=\"uk-border\" width=\"40\" height=\"40\" src={'/static/images/logo-' + service.metadata.id + '.png'} />\r\n          </div>\r\n          <div className=\"uk-width-expand\">\r\n            <h3 className=\"uk-card-title uk-margin-remove-bottom\">{service.metadata.name}</h3>\r\n            <p className=\"uk-text-meta uk-margin-remove-top\">\r\n              Last synced: <time dateTime={startString}>{start}</time>{' '}\r\n              {sync ? '(' + (sync.fetch_count || 0) + ' downloaded) ' :  null}\r\n              â€” Next sync: <time dateTime={nextString}>{next.fromNow()}</time>\r\n            </p>\r\n          </div>\r\n          {configuring || (!service.needs_credentials && !service.needs_app) ? null : <a href=\"#\" onClick={handleConfigureClick} uk-icon=\"icon: cog\" />}\r\n        </div>\r\n      </div>\r\n      {configuring ?\r\n        <div className=\"uk-card-body uk-padding-remove-vertical uk-margin\">\r\n          {service.needs_app ?\r\n            <p>\r\n              Visit {service.metadata.name} to\r\n              <a href={service.app_create_url} uk-tooltip={tooltipString} target=\"_blank\">create an app</a>,{' '}\r\n              then return here and enter the credentials below. Be sure to set the return url to{' '}\r\n              <code>{document.location.protocol + '//' + document.location.host + '/auth/'+service.metadata.id+'/return'}</code>\r\n            </p> :\r\n            <p>\r\n              You already have credentials set up for {service.metadata.name}. If you would like to set new{' '}\r\n              app credentials, head over to their site to{' '}\r\n              <a href={service.app_create_url} uk-tooltip={tooltipString} target=\"_blank\">create or update your app</a>,{' '}\r\n              then return here and enter the credentials below. Be sure to set the return url to{' '}\r\n              <code>{document.location.protocol + '//' + document.location.host + '/auth/'+service.metadata.id+'/return'}</code>\r\n            </p>}\r\n          <OAuthAppForm secretName={service.metadata.id} setShowing={setConfiguring} />\r\n        </div> : null}\r\n      {!configuring && (service.needs_app || service.needs_credentials) ?\r\n        <div className=\"uk-card-body uk-padding-remove-vertical uk-margin\">\r\n          <OAuthSetupPrompt kind=\"service\" name={service.metadata.name} item={service} onConfigureClick={handleConfigureClick} />\r\n        </div> : null}\r\n      <div className=\"uk-card-footer\">\r\n        <a href=\"#\" className=\"uk-button uk-button-text\">View details</a>\r\n        <p className=\"uk-align-right\">\r\n          {service.needs_credentials ? null :\r\n            <button className=\"uk-button uk-button-primary\" disabled={service.current_sync} onClick={syncCallback}>\r\n              {service.current_sync ? 'Syncing...' : 'Sync now'}\r\n            </button>}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAIA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;;;;A","sourceRoot":""}