{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.0fcd55e75d533c7e2273.hot-update.js","sources":["webpack:///./fetchers/common.js","webpack:///./fetchers/services.js","webpack:///./fetchers/targets.js"],"sourcesContent":["export async function extractMessageFromJSONError(resp) {\r\n  try {\r\n    const errJson = await resp.json();\r\n    if (errJson.error) {\r\n      return errJson.error;\r\n    }\r\n    return 'Completed fetch but got error from resource: ' + errJson;\r\n  } catch (err) {\r\n    return 'Completed fetch but got bad status from resource: ' + resp.status + ' (' + err + ')';\r\n  }\r\n}\r\n\r\nexport async function throwMessageFromJSONError(resp) {\r\n  const msg = await extractMessageFromJSONError(resp);\r\n  throw msg;\r\n}","import httpFetch from '../fetch';\r\nimport config from '../config';\r\nimport { getInstalledCSRF } from '../setup';\r\nimport { throwMessageFromJSONError } from './common';\r\n\r\nexport async function fetchServices() {\r\n  try {\r\n    const result = await httpFetch(config.apiPrefix + '/resources/services.json');\r\n    if (result.ok) {\r\n      const services = await result.json();\r\n      for (let i = 0; i < services.length; ++i) {\r\n        const service = services[i];\r\n        const sync = service.last_sync;\r\n        if (!sync) {\r\n          continue;\r\n        }\r\n        sync.startString = sync.start;\r\n        sync.start = Date.parse(sync.start);\r\n        if (sync.end) {\r\n          sync.endString = sync.end;\r\n          sync.end = Date.parse(sync.end);\r\n        }\r\n      }\r\n      return services;\r\n    } else {\r\n      await throwMessageFromJSONError(result);\r\n    }\r\n  } catch (err) {\r\n    throw 'Could not complete fetch: ' + err;\r\n  }\r\n}\r\n\r\nexport async function fetchServiceSyncStart(serviceID) {\r\n  const url = config.apiPrefix + '/resources/service/sync.json?service='+serviceID;\r\n  const resp = await httpFetch(url, {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      'X-CSRF-Token': getInstalledCSRF(),\r\n    },\r\n    credentials: 'include',\r\n  });\r\n  if (!resp.ok) {\r\n    await throwMessageFromJSONError(resp);\r\n  }\r\n  const data = await resp.json();\r\n  return data;\r\n}","import httpFetch from '../fetch';\r\nimport config from '../config';\r\nimport { getInstalledCSRF } from '../setup';\r\nimport { throwMessageFromJSONError } from './common';\r\n\r\nexport async function fetchTargets() {\r\n  try {\r\n    const result = await httpFetch(config.apiPrefix + '/resources/targets.json');\r\n    if (result.ok) {\r\n      const targets = await result.json();\r\n      for (let i = 0; i < targets.length; ++i) {\r\n        const target = targets[i];\r\n        const split = target.url.split('://');\r\n        target.kind = split[0];\r\n        target.path = decodeURIComponent(split[1].substring(1));\r\n      }\r\n      return targets\r\n    } else {\r\n      await throwMessageFromJSONError(result);\r\n    }\r\n  } catch (err) {\r\n    throw 'Could not complete fetch: ' + err;\r\n  }\r\n}\r\n\r\nasync function fetchTargetOperation(operation, url) {\r\n  const apiURL = config.apiPrefix + '/resources/target/' + operation + '.json?url=' + encodeURIComponent(url);\r\n  var resp = null;\r\n  try {\r\n    resp = await httpFetch(apiURL, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'X-CSRF-Token': getInstalledCSRF(),\r\n      },\r\n      credentials: 'include',\r\n    });\r\n    if (!resp.ok) {\r\n      await throwMessageFromJSONError(resp);\r\n    }\r\n  } catch (err) {\r\n    throw 'Could not complete fetch: ' + err;\r\n  }\r\n  try {\r\n    return await resp.json();\r\n  } catch (err) {\r\n    throw 'Could not parse JSON: ' + err;\r\n  }\r\n}\r\n\r\nexport async function fetchTargetRemove(url) {\r\n  return fetchTargetOperation('remove', url);\r\n}\r\n\r\nexport async function fetchTargetAdd(url) {\r\n  return fetchTargetOperation('add', url);\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAYA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAIA;AACA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AACA;AARA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAWA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAjBA;AAKA;AALA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AA2BA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAGA;AACA;AACA;AACA;AAFA;AAIA;AANA;AACA;AAHA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAaA;AAbA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;AChCA;AACA;AACA;AACA;AAEA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAXA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAoBA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAKA;AACA;AACA;AACA;AAFA;AAIA;AANA;AACA;AALA;AAIA;AACA;AALA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAyBA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAIA;AAAA;AAAA;AACA;;;;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;A","sourceRoot":""}