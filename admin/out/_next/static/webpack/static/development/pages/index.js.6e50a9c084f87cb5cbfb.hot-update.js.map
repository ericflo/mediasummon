{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.6e50a9c084f87cb5cbfb.hot-update.js","sources":["webpack:///./components/AddTargetModal.js","webpack:///./pages/index.js"],"sourcesContent":["import React from 'react';\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { fetchTargetAdd } from '../fetchers/targets';\r\n\r\nasync function handleSaveClick(url, setErrorMessage) {\r\n  try {\r\n    await fetchTargetAdd(url, setErrorMessage);\r\n  } catch (err) {\r\n    setErrorMessage('' + err);\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction nameForProtocol(protocol) {\r\n  switch (protocol) {\r\n  case 'file':\r\n    return 'Local Directory';\r\n  case 'gdrive':\r\n    return 'Google Drive';\r\n  case 'dropbox':\r\n    return 'Dropbox';\r\n  case 's3':\r\n    return 'S3';\r\n  }\r\n  return 'Unknown';\r\n}\r\n\r\nexport default function AddTargetModal({ enabled, setIsAdding, setErrorMessage }) {\r\n  const [selfVal, setSelfVal] = useState(null);\r\n  const [protocol, setProtocol] = useState('file');\r\n  const [pathVal, setPathVal] = useState(null);\r\n  useEffect(() => {\r\n    const showing = selfVal && enabled;\r\n    if (showing) {\r\n      require('uikit').modal(selfVal).show();\r\n    }\r\n    return () => {\r\n      if (showing) {\r\n        require('uikit').modal(selfVal).hide();\r\n      }\r\n    };\r\n  }, [selfVal, enabled]);\r\n  const closeCallback = useCallback(ev => {\r\n    ev.preventDefault();\r\n    setIsAdding(false);\r\n  }, [selfVal]);\r\n  const refCallback = useCallback(ref => {\r\n    setSelfVal(ref);\r\n  }, []);\r\n  const protocolChangeCallback = useCallback(ev => {\r\n    setProtocol(ev.target.value);\r\n  }, []);\r\n  const pathValueChangeCallback = useCallback(ev => {\r\n    setPathVal(ev.target.value);\r\n  }, []);\r\n  const saveCallback = useCallback(ev => {\r\n    handleSaveClick(protocol+'://'+pathVal, setErrorMessage);\r\n  }, [protocol, pathVal]);\r\n  return (\r\n    <div uk-modal=\"true\" ref={refCallback}>\r\n      <div className=\"uk-modal-dialog\">\r\n        <button\r\n          className=\"uk-modal-close-default\"\r\n          type=\"button\"\r\n          uk-close=\"true\"\r\n          onClick={closeCallback} />\r\n        <div className=\"uk-modal-header\">\r\n          <h2 className=\"uk-modal-title\">Summon your media to a new location</h2>\r\n        </div>\r\n        <div className=\"uk-modal-body\">\r\n          <p>Choose the additional location where you would like to save your media</p>\r\n          <form className=\"uk-form uk-flex\">\r\n            <span className=\"uk-width-auto\" uk-form-custom=\"target: true\">\r\n              <input className=\"uk-input uk-width-auto\" type=\"text\" placeholder={nameForProtocol(protocol)} />\r\n              <select className=\"uk-select\" onChange={protocolChangeCallback}>\r\n                <option value=\"file\">{nameForProtocol('file')}</option>\r\n                {/*\r\n                <option value=\"gdrive\">{nameForProtocol('gdrive')}</option>\r\n                <option value=\"dropbox\">{nameForProtocol('dropbox')}</option>\r\n                <option value=\"s3\">{nameForProtocol('s3')}</option>\r\n                */}\r\n              </select>\r\n            </span>\r\n            <input\r\n              type=\"text\"\r\n              className=\"uk-input uk-width-expand\" \r\n              placeholder=\"/path/to/your/media/directory\"\r\n              onChange={pathValueChangeCallback} />\r\n          </form>\r\n        </div>\r\n        <div className=\"uk-modal-footer uk-text-right\">\r\n          <button className=\"uk-button uk-button-default\" type=\"button\" onClick={closeCallback}>Cancel</button>\r\n          <button className=\"uk-button uk-button-primary\" type=\"button\" onClick={saveCallback}>Save</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","import '../node_modules/uikit/dist/css/uikit.min.css';\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport { ensureInstalled } from '../setup';\r\nimport { fetchServices } from '../fetchers/services';\r\nimport { fetchTargets, fetchTargetRemove } from '../fetchers/targets';\r\nimport ServiceSummary from '../components/ServiceSummary';\r\nimport TargetSummary from '../components/TargetSummary';\r\nimport AddTargetModal from '../components/AddTargetModal';\r\nimport Header from '../components/Header';\r\n\r\nasync function handleTargetRemoveClick(target, targets, setTargets, setErrorMessage) {\r\n  const UIKit = require('uikit');\r\n  try {\r\n    await UIKit.modal.confirm('Are you sure you want to remove this sync target? (' + target.path + ')');\r\n  } catch (err) {\r\n    return;\r\n  }\r\n  try {\r\n    const result = await fetchTargetRemove(target.url, setErrorMessage);\r\n    console.log('remove result', result);\r\n    setTargets(targets.filter(t => t.url !== target.url));\r\n  } catch (err) {\r\n    setErrorMessage('' + err);\r\n  }\r\n  return false;\r\n}\r\n\r\nexport default function Home() {\r\n  const [services, setServices] = useState([]);\r\n  const [targets, setTargets] = useState([]);\r\n  const [errorMessage, setErrorMessage] = useState(null);\r\n  const [isAdding, setIsAdding] = useState(false);\r\n  useEffect(() => {\r\n    ensureInstalled();\r\n    fetchServices(setServices, setErrorMessage);\r\n    fetchTargets(setTargets, setErrorMessage);\r\n  }, []);\r\n  useEffect(() => {\r\n    const timer = setInterval(() => {\r\n      if (targets.length) {\r\n        fetchServices(setServices, setErrorMessage);\r\n      }\r\n    }, 1000);\r\n    return () => clearInterval(timer);\r\n  }, [targets]);\r\n  const removeTargetClickCallback = useCallback(target => {\r\n    handleTargetRemoveClick(target, targets, setTargets, setErrorMessage);\r\n  }, [targets]);\r\n  const addTargetClickCallback = useCallback(ev => {\r\n    ev.preventDefault();\r\n    setIsAdding(true);\r\n  }, []);\r\n  return (\r\n    <div className=\"uk-container\">\r\n      <Header title=\"Mediasummon\" />\r\n      <AddTargetModal setIsAdding={setIsAdding} enabled={isAdding} setErrorMessage={setErrorMessage} />\r\n      {errorMessage ? \r\n        <div className=\"uk-alert-danger\" uk-alert=\"true\">\r\n          <a className=\"uk-alert-close\" uk-close=\"true\"></a>\r\n          <p><span uk-icon=\"warning\" /> {errorMessage}</p>\r\n        </div> : null}\r\n      <div className=\"uk-section uk-section-default uk-padding-remove-top\">\r\n        <h3>Summoning your media to these locations</h3>\r\n        {targets.map(target => {\r\n          return (\r\n            <TargetSummary\r\n              key={target.url}\r\n              target={target}\r\n              onRemoveClick={removeTargetClickCallback} />\r\n          );\r\n        })}\r\n        <div className=\"uk-flex uk-flex-center\">\r\n          <a\r\n            href=\"#\"\r\n            uk-icon=\"icon: plus-circle; ratio: 2\" \r\n            onClick={addTargetClickCallback} />\r\n        </div>\r\n      </div>\r\n      <div className=\"uk-section uk-section-default uk-padding-remove\">\r\n        <h3>Summoning media from these services</h3>\r\n        {services.map(service => {\r\n          return <ServiceSummary key={service.metadata.id} service={service} />;\r\n        })}\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"mappings":"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","sourceRoot":""}