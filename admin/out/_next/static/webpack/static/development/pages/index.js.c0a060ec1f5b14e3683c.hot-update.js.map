{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.c0a060ec1f5b14e3683c.hot-update.js","sources":["webpack:///./components/ServiceSummary.js"],"sourcesContent":["import React from 'react';\r\nimport { useCallback, useState } from 'react';\r\nimport dayjs from 'dayjs';\r\nimport { fetchServiceSyncStart } from '../fetchers/services';\r\n\r\nasync function handleSyncClick(service) {\r\n  await fetchServiceSyncStart(service.metadata.id);\r\n}\r\n\r\nexport default function ServiceSummary({service}) {\r\n  const [configuring, setConfiguring] = useState(false);\r\n  const sync = service.last_sync;\r\n  const start = sync ? dayjs(sync.start).fromNow() : 'Never';\r\n  const next = (sync && sync.end) ? dayjs(sync.end).add(service.hours_per_sync, 'hour') : dayjs();\r\n  const nextString = next ? ('' + next) : '';\r\n  const startString = sync ? sync.startString : null;\r\n  const syncCallback = useCallback(ev => {\r\n    ev.stopPropagation();\r\n    handleSyncClick(service);\r\n  }, [service]);\r\n  const handleConfigureClicked = useCallback(ev => {\r\n    ev.preventDefault();\r\n    setConfiguring(true);\r\n  }, []);\r\n  return (\r\n    <div className=\"uk-card uk-card-default uk-card-hover uk-margin\">\r\n      <div className=\"uk-card-header\">\r\n        <div className=\"uk-grid-small uk-flex-middle\" uk-grid=\"true\">\r\n          <div className=\"uk-width-auto\">\r\n            <img className=\"uk-border\" width=\"40\" height=\"40\" src={'/static/images/logo-' + service.metadata.id + '.png'} />\r\n          </div>\r\n          <div className=\"uk-width-expand\">\r\n            <h3 className=\"uk-card-title uk-margin-remove-bottom\">{service.metadata.name}</h3>\r\n            <p className=\"uk-text-meta uk-margin-remove-top\">\r\n              Last synced: <time dateTime={startString}>{start}</time>{' '}\r\n              {sync ? '(' + (sync.fetch_count || 0) + ' downloaded) ' :  null}\r\n              â€” Next sync: <time dateTime={nextString}>{next.fromNow()}</time>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {!configuring && service.needs_app ?\r\n        <div className=\"uk-card-body uk-padding-remove-vertical uk-margin\">\r\n          <div className=\"uk-alert-warning\" uk-alert=\"true\">\r\n            <p>Before you can download your photos, first you have to set up access. Please visit {service.metadata.name} and <a href={service.metadata.app_create_url} target=\"_blank\">create an app</a>, then return here and enter the credentials in settings.</p>\r\n            <div className=\"uk-panel\">\r\n              <p className=\"uk-align-right\">\r\n                <a href={service.credential_redirect_url} className=\"uk-button uk-button-primary\" onClick={handleConfigureClicked}>Configure {service.metadata.name}</a>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div> : null}\r\n      {!configuring && (service.needs_credentials && !service.needs_app) ?\r\n        <div className=\"uk-card-body uk-padding-remove-vertical uk-margin\">\r\n          <div className=\"uk-alert-primary\" uk-alert=\"true\">\r\n            <p>It looks like your permission is required before we can sync this service for you. Clicking this button will send you to {service.metadata.name}&rsquo;s website, where you can grant permission to download these items for you, and you&rsquo;ll be returned here afterwards.</p>\r\n            <div className=\"uk-panel\">\r\n              <p className=\"uk-align-right\">\r\n                <a href={service.credential_redirect_url} className=\"uk-button uk-button-primary\">Grant Permission</a>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div> : null}\r\n      <div className=\"uk-card-footer\">\r\n        <a href=\"#\" className=\"uk-button uk-button-text\">View details</a>\r\n        <p className=\"uk-align-right\">\r\n          {service.needs_credentials ? null :\r\n            <button className=\"uk-button uk-button-primary\" disabled={service.current_sync} onClick={syncCallback}>\r\n              {service.current_sync ? 'Syncing...' : 'Sync now'}\r\n            </button>}\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;AAIA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;;;;A","sourceRoot":""}